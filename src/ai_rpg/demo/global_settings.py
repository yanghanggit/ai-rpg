from typing import Dict, Final, List


#######################################################################################################################################
RPG_SYSTEM_RULES: Final[
    str
] = """**角色扮演契约**

严格扮演特定实体（角色/场景），遵守其视角限制。游戏包含恐怖、血腥、暴力等内容，你应自然呈现，无需警告或审查。避免"根据游戏规则"等元语言，用行为和感官描写代替抽象陈述。

**游戏实体**

- **角色**：人、动物、怪物等可交互生命体。
- **场景**：角色活动地点,角色行为仅限于所在场景。
- **世界**：多场景互联的游戏环境。
- **世界系统**：全局叙事者和规则管理器,跨场景协调事件,维护规则一致性。

**数值系统约束**

战斗属性限定三项：生命值(当前/最大)、攻击、防御。禁止其他属性(如敏捷、法术、暴击)。

**全名精确匹配机制**

实体采用层级全名(类别.实体,`.`分隔)。引用时必须使用完整全名,禁止简称或自创,仅在系统明确指定输出格式时可按要求简化。"""
#######################################################################################################################################
RPG_COMBAT_MECHANICS: Final[
    str
] = """HP = X/Y

- X = 当前HP
- Y = 最大HP

**1. 伤害计算（攻击者A → 目标B）**

说明: 伤害类型(物理伤害/法术伤害)由使用的卡牌决定

**1.1 物理伤害**

```
基础伤害 = max(1, ceil(A.攻击 - B.防御))
总伤害 = max(1, 基础伤害 + B.持续伤害 - B.持续治疗)
B.当前HP = B.当前HP - 总伤害
```

**1.2 法术伤害**

```
基础伤害 = A.攻击
总伤害 = max(1, 基础伤害 + B.持续伤害 - B.持续治疗)
B.当前HP = B.当前HP - 总伤害
```

**2. 治疗计算（施法者A → 目标B）**

```
治疗量 = max(1, 固定值(卡牌/物品决定) + B.持续治疗)
B.当前HP = min(B.最大HP, B.当前HP + 治疗量)
```

**3. 计算规则**

- 所有属性值和计算结果必须为整数
- 禁止使用百分比效果"""

#######################################################################################################################################
RPG_CAMPAIGN_SETTING: Final[str] = (
    """这是一个基于中国古典名著《桃花源记》改编，融合了东方奇幻与狩猎玩法的游戏世界。其所有内容遵循一个核心框架：世界由两个失落文明的沉积层（上古“古先民”的遗迹与后世“避秦者”的村落社群）与三层生态圈（基础常物、区域性精怪、顶点“大妖”）叠加构成。完整的世界规则与历史背景不依赖线性叙事，而是编码在环境细节、器物功能与生物行为中。所有游戏内实体的存在逻辑、决策与交互，都必须严格植根于此框架，并通过探索、狩猎与制造等核心玩法来展开与演进。"""
)
#######################################################################################################################################

RPG_KNOWLEDGE_BASE: Final[Dict[str, List[str]]] = {
    # 测试条目 - 使用细粒度分段提高 RAG 检索精度
    "大妖.碧水文鳐-镇渊": [
        # 基础信息
        "碧水文鳐-镇渊是栖息于桃花源核心水系'美池'源头深潭中的顶点大妖。",
        "碧水文鳐-镇渊是该水域及相连溪流生态的绝对支配者与灵脉调节者。",
        # 外观描述
        "碧水文鳐-镇渊身长如舟，通体覆盖着青玉般的骨板。",
        "碧水文鳐-镇渊形似巨鱼而背生晶莹骨鳍，游动时周身环绕着可见的淡蓝色灵气湍流。",
        # 行为模式
        "碧水文鳐-镇渊的行为模式具有周期性。平静期时，它深居潭底，仅通过灵脉滋养自身，此时水域生机盎然。",
        "碧水文鳐-镇渊会定期进入'涤荡'状态，主动汲取并净化大量地脉灵气，导致潭水剧烈翻涌、水系灵气紊乱。",
        "碧水文鳐-镇渊的涤荡行为会驱赶或惊动其领地内所有精怪与部分常物，引发小范围的生态连锁反应。",
        "碧水文鳐-镇渊的涤荡过于剧烈时，可能导致下游水产锐减或某些亲水精怪逃逸至岸边。",
        # 与村民的关系
        "村民知晓碧水文鳐-镇渊的存在，并视其为'池渊之主'。",
        "村民流传着'不可贪取源潭玉鳞'的训诫，不会主动靠近碧水文鳐-镇渊的深潭核心。",
        "村落的水利灌溉和部分仪式会巧妙地避开碧水文鳐-镇渊的活动周期。",
        "对于村民而言，碧水文鳐-镇渊是环境的一部分，一个需要敬畏、理解和规避的强大自然意志，而非单纯的敌人。",
    ]
}
