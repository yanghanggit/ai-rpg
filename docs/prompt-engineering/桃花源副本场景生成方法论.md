# 桃花源副本场景 提示词生成方法论

## 核心原则

从代码中的副本场景描述（`StageProfile`）生成图像提示词：

- **输入**：name（场景名）+ profile（文字描述）
- **输出**：正向提示词 + 负向提示词
- **场景类型**：DUNGEON（战斗副本）

---

## 固定参数

- **尺寸**：1080 x 1920（竖屏）
- **模型**：nano-banana
- **风格**：中国传统水墨画

---

## 提示词模板

### 正向提示词（7段式）

```text
中国传统水墨画风格融合自然场景写实，竖幅构图，纯背景插画艺术作品。
桃花源山脉的[场景名称]，[地形地貌描述]。
[地面材质、植被状态、岩石分布]。
[环境物品、妖兽痕迹、危险标记]。
[光线环境、大气氛围]，营造[危险/神秘]感受。
水墨晕染技法，[色调]，笔触[风格特点]。
前景[地面细节]，中景[核心环境]，背景[山林虚化]。画面氛围[形容词]，但不出现人物和妖兽。纯粹的背景艺术，无任何文字、标题、按钮或界面元素。
```

### 负向提示词（通用）

```text
人物，人脸，角色，猎人，战士，妖兽，动物，怪物，山魈，老虎，现代元素，现代建筑，城市景观，鲜艳色彩，卡通风格，动漫，照片写实，西方建筑，构图杂乱，文字，汉字，英文字母，标志，logo，标题，游戏标题，按钮，UI界面，游戏界面，START，PLAY，框架，边框，装饰框，红框，过度饱和，油画质感
```

---

## 生成步骤

1. **读取 profile**：提取地形、植被、危险标记、氛围关键词
2. **判断危险等级**：边缘区域（低危）还是深处区域（高危）
3. **填充模板**：把关键词填入7段式结构
4. **添加尾缀**：固定加上"不出现人物和妖兽"和"无UI元素"

---

## 关键原则

- ✅ **暗示危险**：写"树干上的爪痕"、"散落的兽骨"，不写"老虎正在巡视"
- ✅ **静态环境**：写"地面散落"、"周围散布"，不写"妖兽活动"
- ✅ **明确排除**：必须加"不出现人物和妖兽"和"无UI元素"
- ✅ **危险氛围**：通过环境细节（爪痕、兽骨、压抑感）传达危险，而非直接展示妖兽

---

## 副本场景特点

### 与村落场景的区别

| 维度 | 村落子场景 | 副本场景 |
| ------ | ----------- | --------- |
| **场景类型** | HOME（安全区） | DUNGEON（危险区） |
| **环境** | 室内/室外人工建筑 | 自然环境、野外 |
| **氛围** | 温馨/实用/庄重 | 危险/神秘/压抑 |
| **功能** | 休息、补给、社交 | 战斗、探险 |
| **核心元素** | 家具、工具、陈设 | 地形、植被、妖兽痕迹 |
| **排除重点** | 不出现人物 | 不出现人物**和妖兽** |

### 危险等级表现

**低危区域**（如山林边缘）：

- 环境：树木稀疏、视野开阔
- 光线：明亮、透光
- 氛围：警惕、但可控
- 痕迹：散落的石块、断枝

**高危区域**（如密林深处）：

- 环境：古木参天、遮蔽天日
- 光线：昏暗、压抑
- 氛围：沉闷、危险
- 痕迹：深深的爪痕、巨大的兽骨

---

## 参考

- 代码实现：`src/ai_rpg/demo/dungeon_mountain_beasts.py`
- 村落场景：`桃花源村落子场景生成方法论.md`
